$(document).ready(function(){jQuery.validator.addMethod("notEqual",function(n,t,o){return this.optional(t)||n!=$(o).val()},"数据不能相同");var n=function(n){return!n||0===n.length},t=function(n){for(var t=new Array,o=0;o<n.length;o++)n[o]&&t.push(n[o]);return t},o=function(n){return t(n.split("-")).reverse().join("-")},r=function(n){var t="";return TOWN_AREA[n]&&(t+=TOWN_AREA[n].name,t+=r(TOWN_AREA[n].parent)),CITY_AREA[n]&&(t+="-"+CITY_AREA[n].name,t+=r(CITY_AREA[n].parent)),PROVINCE_AREA[n]&&(t+="-"+PROVINCE_AREA[n].name),t},e=function(n){var t=-1;return n[2]?t=n[2]:n[1]?t=n[1]:n[0]&&(t=n[0]),t},i=function(){var t=$(".search-form input[name=qSource]").val();t&&($("#sourceDropdown input[type=text]").val(o(r(t))),$("#sourceDropdown input[type=hidden]").val(t));var e=$(".search-form input[name=qDestination]").val();e&&($("#destinationDropdown input[type=text]").val(o(r(e))),$("#destinationDropdown input[type=hidden]").val(e)),$("#sourceDropdown").cityDropdown(),$("#destinationDropdown").cityDropdown(),$(".search-form").on("click","#exchange",function(t){t.preventDefault();var o=$("#sourceDropdown-cityInput").val(),r=$("#destinationDropdown-cityInput").val();if(!n(o)||!n(r)){var e=window.__CITYDATA__.sourceDropdown,i=window.__CITYDATA__.destinationDropdown;$("#sourceDropdown-cityInput").val(r),$("#destinationDropdown-cityInput").val(o),window.__CITYDATA__.sourceDropdown=i,window.__CITYDATA__.destinationDropdown=e}return!1})},a=function(){i();$("#citySearchForm").validate({rules:{source:{required:!0},destination:{required:!0,notEqual:"#sourceDropdown-cityInput"}},messages:{source:{required:'<p style="width: 96px;height: 17px;margin-bottom: 0px;">出发地不能为空</p>'},destination:{required:'<p style="width: 96px;height: 17px;margin-bottom: 0px;">目的地不能为空</p>',notEqual:'<p style="width: 120px;height: 17px;margin-bottom: 0px;">出发地目的地不能相同</p>'}},tooltip_options:{source:{placement:"top",html:!0},destination:{placement:"top",html:!0}}});$(".search-form").on("click","#searchBtn",function(n){n.preventDefault();var t=$("#citySearchForm");if(t.find("input").each(function(){$(this).val(jQuery.trim($(this).val()))}),t.valid()){var o=e(window.__CITYDATA__.sourceDropdown),r=e(window.__CITYDATA__.destinationDropdown),i="/mendaomen/"+o+"-"+r+"/index-1.html";window.location.href=i}return!1}),$(".title-row").on("click","#costtimeSort",function(n){n.preventDefault();var t=$(this).data("value");t=t&&11!=t?11:10,$("#searchForm input[name=orderBy]").val(t),$("form#searchForm").submit()}),$(".title-row").on("click","#priceSort",function(n){n.preventDefault();var t=$(this).data("value");t=t&&21!=t?21:20,$("#searchForm input[name=orderBy]").val(t),$("form#searchForm").submit()}),$(".condition-row").on("click","#specialOfferInput",function(){var n=0;$(this).prop("checked")&&(n=1),$("#searchForm input[name=isSpecialOffer]").val(n),$("form#searchForm").submit()})};a()});